"use strict";const e=async(e,t)=>{const o=await fetch(e,t);if(o.ok)return await o.json();throw new Error(`${o.status} ${o.statusText}`)},t=document.querySelector(".main-nav__menu-button"),o=document.querySelector(".main-nav"),s=["main-nav--opened","main-nav--closed"],r=(e,t,o)=>{e.addEventListener("click",(()=>{for(const e of o)t.classList.toggle(e)}))};o.classList.add("main-nav--closed"),o.classList.remove("main-nav--no-js"),r(t,o,s);const n="popup--show",i=(e,t)=>{const o=()=>{t.removeEventListener("click",r),document.removeEventListener("keydown",s),e.classList.remove("popup--show")},s=e=>{"Escape"!==e.key&&"Esc"!==e.key||(e.preventDefault(),o())},r=e=>{e.preventDefault(),o()};e.classList.add("popup--show"),t.addEventListener("click",r),document.addEventListener("keydown",s)},l=document.querySelector(".contest__form"),a=document.querySelector(".popup--succes"),c=document.querySelector(".popup--succes .popup__submit"),u=document.querySelector(".popup--failure"),d=document.querySelector(".popup--failure .popup__submit"),m="form__warning",p=(e,t,o,s,r,n)=>{const l=e.querySelectorAll("[required]");for(const e of l)e.removeAttribute("required");e.addEventListener("submit",(a=>{let c=!1;for(let e=l.length-1;e>=0;e--)l[e].classList.remove(t),l[e].value||(c=!0,l[e].classList.add(t),l[e].scrollIntoView());c?(a.preventDefault(),i(r,n)):(a.preventDefault(),i(o,s),e.reset())}))};l&&a&&u&&p(l,"form__warning",a,c,u,d);const _=document.querySelector(".album"),v=document.querySelector(".popup--photo"),b="likes__button--liked";if(_&&v){const t=_.querySelector(".album__list"),o="./data/albumData.json",s=v.querySelector(".popup__full-picture"),r=v.querySelector(".popup__download--file"),n=v.querySelector(".popup__download--cancel"),l=(e,t,o)=>{e.classList.contains(o)?t.textContent--:t.textContent++,e.classList.toggle(o),document.activeElement.blur()},a=e=>{const t=e.href;s.src=t,r.href=t,i(v,n)};_.addEventListener("click",(e=>{const t=e.target.closest(".album__item"),o=e.target.closest(".album__photo-link"),s=e.target.closest(".likes__button"),r=t.querySelector(".likes__count");return o?(e.preventDefault(),void a(o)):s&&r?(e.preventDefault(),void l(s,r,"likes__button--liked")):void 0})),e(o).then((e=>{t.innerHTML=e.map((({authorName:e,datetime:t,time:o,comment:s,likes:r,fileName:n})=>`\n          <li class="album__item">\n            <a class="album__photo-link" href="img/hi-res/photo-1.jpg">\n              <picture>\n                <source type="image/webp" media="(min-width: 960px)" srcset="img/${n}--desktop.webp 1x, img/${n}--desktop@2x.webp 2x">\n                <source type="image/webp" media="(min-width: 660px)" srcset="img/${n}--tablet.webp 1x, img/${n}--tablet@2x.webp 2x">\n                <source type="image/webp" srcset="img/${n}--mobile.webp 1x, img/${n}--mobile@2x.webp 2x">\n                <source media="(min-width: 960px)" srcset="img/${n}--desktop.jpg 1x, img/${n}--desktop@2x.jpg 2x">\n                <source media="(min-width: 660px)" srcset="img/${n}--tablet.jpg 1x, img/${n}--tablet@2x.jpg 2x">\n                <img class="album__photo" src="img/${n}--mobile.jpg" srcset="img/${n}--mobile@2x.jpg 2x" width="280" height="180" alt="фото конкурса." loading="lazy">\n              </picture>\n            </a>\n            <div class="album__caption">\n              <blockquote class="album__description">\n                <p class="album__source">\n                  <cite class="album__author">${e}</cite>\n                  <time class="album__time" datetime="${t}">(${o})</time>\n                </p>\n                <p class="album__comment">${s}</p>\n              </blockquote>\n              <div class="album__likes likes">\n                <button class="likes__button button" type="button"><span class="visually-hidden">Поставить лайк</span></button>\n                <p class="likes__text">Нравится: <span class="likes__count">${r}</span></p>\n              </div>\n            </div>\n          </li>\n        `)).join("")}))}const h=document.querySelector(".photo-editor__interface");if(h){const e=h.querySelector(".photo-editor__image"),t=h.querySelector(".photo-editor__image-overlay"),o=h.querySelector(".photo-editor__controls"),s=h.querySelectorAll(".photo-editor__tool"),r=h.querySelectorAll(".photo-editor__range"),n=h.querySelector(".photo-editor__range--crop input"),i=h.querySelector(".photo-editor__range--fill input"),l=h.querySelector(".photo-editor__range--contrast input"),a=h.querySelector(".photo-editor__button--reset");o.addEventListener("click",(e=>{const t=e.target.closest(".photo-editor__tool");if(t){e.preventDefault();for(const e of s)e.classList.remove("photo-editor__tool--current");t.classList.add("photo-editor__tool--current");for(const e of r)e.dataset.tool===t.dataset.tool?e.classList.add("photo-editor__range--current"):e.classList.remove("photo-editor__range--current");document.activeElement.blur()}}));const c=()=>{e.style.transform=`scale(${1+.04*n.value})`},u=()=>{t.style.opacity=.01*i.value},d=()=>{e.style.filter=`contrast(${.015*l.value+.25})`},m=()=>{n.value=0,c(),i.value=0,u(),l.value=50,d()};n.addEventListener("input",c),i.addEventListener("input",u),l.addEventListener("input",d),a.addEventListener("click",m)}const g=(e,{workScreenWidthMax:t=1/0,swipeThreshold:o=.3,transitionDuration:s=.7})=>{const r=e.querySelector(".slider__wrapper"),n=e.querySelector(".slider__list"),i=e.querySelectorAll(".slider__item"),l=e.querySelectorAll(".slider__button"),a=l[0],c=l[1],u=e.querySelectorAll(".slider__markers-item");let d=0,m=0,p=0,_=0,v=0,b=0,h=0,g=!1,y=!1,f=!0,L=!0,w=0,k=0;const x=/([-0-9.]+(?=px))/;let q,S,E;const $=()=>{q=i[0].offsetWidth,S=q*o,E=(i.length-1)*q},j=()=>document.documentElement.clientWidth>t,D=(e=0)=>{for(const e of u)e.classList.remove("slider__markers-item--current");u[e].classList.add("slider__markers-item--current")};D();const A=e=>-1!==e.type.search("touch")?e.touches[0]:e,T=()=>{$(),D(d),L&&(n.style.transition=`transform ${s}s ease-out`),n.style.transform=`translate3d(-${d*q}px, 0px, 0px)`,a.classList.toggle("slider__button--disabled",0===d),a.toggleAttribute("disabled",0===d),c.classList.toggle("slider__button--disabled",d===i.length-1),c.toggleAttribute("disabled",d===i.length-1)},M=e=>{if($(),j())return;let t=A(e);f&&(L=!0,w=(d+1)*-q,k=(d-1)*-q,m=p=t.clientX,v=t.clientY,n.style.transition="",document.addEventListener("touchmove",W),document.addEventListener("touchend",H),document.addEventListener("mousemove",W),document.addEventListener("mouseup",H),r.classList.remove("grab"),r.classList.add("grabbing"))},W=e=>{let t=A(e),o=+n.style.transform.match(x)[0];if(_=p-t.clientX,p=t.clientX,b=v-t.clientY,v=t.clientY,!g&&!y){Math.abs(b)>11||0===_?(y=!0,f=!1):g=!0}if(g){if(0===d&&p>m)return void N(o,0);if(d===i.length-1&&p<m)return void N(o,E);if(f=!0,m>p&&o<w||m<p&&o>k)return void X();n.style.transform=`translate3d(${o-_}px, 0px, 0px)`}},H=()=>{$(),h=Math.abs(m-p),y=!1,g=!1,document.removeEventListener("touchmove",W),document.removeEventListener("mousemove",W),document.removeEventListener("touchend",H),document.removeEventListener("mouseup",H),r.classList.add("grab"),r.classList.remove("grabbing"),f?(h>S&&(p>m?d--:p<m&&d++),p!==m?(f=!1,T()):f=!0):f=!0},N=(e,t)=>{e>=t&&(n.style.transform=`translate3d(${t}px, 0px, 0px)`),f=!1},X=()=>{L=!1,H(),f=!0},Y=e=>{const t=e.target.closest("button");if(t.classList.contains("slider__button-next"))d++;else{if(!t.classList.contains("slider__button-prev"))return;d--}T()};n.style.transform="translate3d(0px, 0px, 0px)",r.classList.add("grab"),n.addEventListener("transitionend",(()=>f=!0)),r.addEventListener("touchstart",M),r.addEventListener("mousedown",M),a.addEventListener("click",Y),c.addEventListener("click",Y),window.addEventListener("resize",(()=>{j()&&(d=0,T())}))},y=(e,t)=>{const o=e.querySelectorAll(".slider__item"),s=e.querySelector(".slider__markers-list");void 0===t&&(t=o.length);let r="";for(let e=0;e<t;e++){r+=`<li class="slider__markers-item">\n      <button class="slider__marker" type="button" name="Slide-${e+1}"><span class="visually-hidden">Слайд номер ${e+1}</span></button>\n    </li>`}s.innerHTML=r},f=document.querySelector(".reviews__wrapper.slider"),L="./data/reviewsData.json";if(f){const t=f.querySelector(".reviews__list");e(L).then((e=>{t.innerHTML=e.map((({authorName:e,authorAbout:t,reviewText:o})=>`\n          <li class="reviews__item slider__item">\n            <blockquote class="reviews__blockquote">\n              <cite class="reviews__author-name">${e}</cite>\n              <p class="reviews__author-about">${t}</p>\n              <p class="reviews__text">«${o}»</p>\n            </blockquote>\n          </li>\n        `)).join(""),y(f),g(f,{swipeThreshold:.2,transitionDuration:.5})}))}const w=document.querySelector(".price__slider.slider");w&&(y(w),g(w,{workScreenWidthMax:659,swipeThreshold:.2,transitionDuration:.1}));